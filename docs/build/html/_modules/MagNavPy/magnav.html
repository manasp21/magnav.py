<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>magnavpy.magnav &#8212; MagNavPy 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for magnavpy.magnav</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Main module for MagNavPy, translated from MagNav.jl.</span>

<span class="sd">This module provides core data structures, constants, utility functions,</span>
<span class="sd">and access to datasets for magnetic navigation.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Union</span> <span class="c1"># Any for some complex types initially</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.common_types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Map</span><span class="p">,</span> <span class="n">MapS</span><span class="p">,</span> <span class="n">MapSd</span><span class="p">,</span> <span class="n">MapS3D</span><span class="p">,</span> <span class="n">MapV</span><span class="p">,</span> <span class="n">MapCache</span><span class="p">,</span> <span class="n">MAP_S_NULL</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span> <span class="c1"># This is only needed if Path or XYZ are defined here and extend ABC</span>

<span class="c1"># Attempt to import packages, with placeholders for those not in requirements.txt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">h5py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">toml</span> <span class="c1"># Standard in Python 3.11+, or pip install toml</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>

<span class="c1"># SciPy imports</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">expm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">multivariate_normal</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">uniform</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">UnivariateSpline</span><span class="p">,</span> <span class="n">interp1d</span><span class="p">,</span> <span class="n">RegularGridInterpolator</span><span class="p">,</span> <span class="n">interpn</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">loadmat</span><span class="p">,</span> <span class="n">savemat</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span> <span class="k">as</span> <span class="n">scipy_minimize</span> <span class="c1"># Renamed to avoid conflict if we define minimize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">gammainc</span><span class="p">,</span> <span class="n">gammaincinv</span>

<span class="c1"># Matplotlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># PyTorch imports (Flux equivalent)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.optim</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">optim</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataLoader</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn.functional</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">F</span>

<span class="c1"># Scikit-learn imports (for GLMNet, MLJLinearModels, KernelFunctions, NearestNeighbors)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">ElasticNetCV</span><span class="p">,</span> <span class="n">ElasticNet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KDTree</span> <span class="k">as</span> <span class="n">SklearnKDTree</span><span class="p">,</span> <span class="n">NearestNeighbors</span> <span class="k">as</span> <span class="n">SklearnNearestNeighbors</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.pairwise</span><span class="w"> </span><span class="kn">import</span> <span class="n">polynomial_kernel</span><span class="p">,</span> <span class="n">rbf_kernel</span>

<span class="c1"># Statsmodels imports (for StatsBase)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">acf</span> <span class="k">as</span> <span class="n">sm_acf</span> <span class="c1"># Renamed</span>

<span class="c1"># GDAL import</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">osgeo</span><span class="w"> </span><span class="kn">import</span> <span class="n">gdal</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">gdal</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Placeholder</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: GDAL not found. Some functionalities might be unavailable.&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>

<span class="c1"># JAX imports (for ForwardDiff, Zygote)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
    <span class="c1"># For JAX, enable float64 if needed, as it defaults to float32</span>
    <span class="c1"># from jax.config import config</span>
    <span class="c1"># config.update(&quot;jax_enable_x64&quot;, True)</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">jax</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">jnp</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Placeholder</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: JAX not found. Autodiff functionalities might be unavailable.&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>


<span class="c1"># --- Helper Functions for path manipulation (from Julia&#39;s internal logic) ---</span>
<div class="viewcode-block" id="add_extension">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.add_extension">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">add_extension</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ext</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds extension if not already present.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ext</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">name</span> <span class="o">+</span> <span class="n">ext</span>
    <span class="k">return</span> <span class="n">name</span></div>


<div class="viewcode-block" id="remove_extension">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.remove_extension">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">remove_extension</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">suffix_to_remove</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes specified suffix if present.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">suffix_to_remove</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">suffix_to_remove</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">name</span></div>


<span class="c1"># --- Project Version ---</span>
<span class="c1"># Path to the original Julia Project.toml to read version</span>
<span class="c1"># This assumes MagNavPy/src/magnav.py and MagNav.jl/Project.toml relative paths</span>
<span class="n">_SCRIPT_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">_PROJECT_TOML_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_SCRIPT_DIR</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;MagNav.jl&quot;</span><span class="p">,</span> <span class="s2">&quot;Project.toml&quot;</span><span class="p">)</span>

<span class="n">MAGNAV_VERSION_STR</span> <span class="o">=</span> <span class="s2">&quot;0.0.0&quot;</span> <span class="c1"># Default</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">_PROJECT_TOML_PATH</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">_project_data</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">MAGNAV_VERSION_STR</span> <span class="o">=</span> <span class="n">_project_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">,</span> <span class="s2">&quot;0.0.0&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Project.toml not found at </span><span class="si">{</span><span class="n">_PROJECT_TOML_PATH</span><span class="si">}</span><span class="s2">. Using default version.&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not read version from Project.toml: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>

<span class="c1"># --- Constants ---</span>
<span class="n">NUM_MAG_MAX</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Maximum number of scalar &amp; vector magnetometers (each)</span>
<span class="n">E_EARTH</span> <span class="o">=</span> <span class="mf">0.0818191908426</span>  <span class="c1"># First eccentricity of Earth [-]</span>
<span class="n">G_EARTH</span> <span class="o">=</span> <span class="mf">9.80665</span>  <span class="c1"># Gravity of Earth [m/s^2]</span>
<span class="n">R_EARTH</span> <span class="o">=</span> <span class="mi">6378137</span>  <span class="c1"># WGS-84 radius of Earth [m]</span>
<span class="n">OMEGA_EARTH</span> <span class="o">=</span> <span class="mf">7.2921151467e-5</span>  <span class="c1"># Rotation rate of Earth [rad/s]</span>

<span class="c1"># Artifacts: Paths to data files.</span>
<span class="c1"># Assumption: An ARTIFACT_DIR environment variable or a known relative path.</span>
<span class="c1"># For now, using a placeholder. Users should configure this.</span>
<span class="c1"># Example: ARTIFACT_DIR = os.getenv(&quot;MAGNAV_ARTIFACT_DIR&quot;, &quot;artifacts&quot;)</span>
<span class="c1"># If ARTIFACT_DIR is relative, it&#39;s relative to where the script is run or a known base.</span>
<span class="c1"># For simplicity in this conversion, we&#39;ll use relative paths from a hypothetical &quot;artifacts&quot; dir</span>
<span class="c1"># that would be a sibling to MagNav.jl and MagNavPy or configured.</span>
<span class="n">_ARTIFACT_BASE_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_SCRIPT_DIR</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;MagNav.jl&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;test_data&quot;</span><span class="p">)</span> <span class="c1"># Fallback to test_data for some, needs proper setup</span>
<span class="n">_DEFAULT_ARTIFACT_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_SCRIPT_DIR</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;artifacts_data&quot;</span><span class="p">)</span> <span class="c1"># A more general placeholder</span>

<span class="c1"># It&#39;s better to define a function or a configuration system for artifacts.</span>
<span class="c1"># For this translation, paths will be constructed assuming _DEFAULT_ARTIFACT_DIR.</span>
<span class="c1"># Users will need to ensure these files exist at the expected locations.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Note: Artifact paths are placeholders. Ensure data exists at expected locations relative to &#39;</span><span class="si">{</span><span class="n">_DEFAULT_ARTIFACT_DIR</span><span class="si">}</span><span class="s2">&#39; or configure properly.&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>

<span class="n">USGS_COLOR_SCALE</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_DEFAULT_ARTIFACT_DIR</span><span class="p">,</span> <span class="s2">&quot;util_files&quot;</span><span class="p">,</span> <span class="s2">&quot;util_files&quot;</span><span class="p">,</span> <span class="s2">&quot;color_scale_usgs.csv&quot;</span><span class="p">)</span>
<span class="n">ICON_CIRCLE</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_DEFAULT_ARTIFACT_DIR</span><span class="p">,</span> <span class="s2">&quot;util_files&quot;</span><span class="p">,</span> <span class="s2">&quot;util_files&quot;</span><span class="p">,</span> <span class="s2">&quot;icon_circle.dae&quot;</span><span class="p">)</span>

<span class="n">SILENT_DEBUG</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Internal flag. If true, no verbose print outs.</span>

<div class="viewcode-block" id="sgl_fields_path">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.sgl_fields_path">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sgl_fields_path</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Data fields in SGL flight data collections.</span>
<span class="sd">    Args:</span>
<span class="sd">        f: (optional) name of data file (.csv extension optional)</span>
<span class="sd">    Returns:</span>
<span class="sd">        path of folder or f data file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p_base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_DEFAULT_ARTIFACT_DIR</span><span class="p">,</span> <span class="s2">&quot;sgl_fields&quot;</span><span class="p">,</span> <span class="s2">&quot;sgl_fields&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p_base</span><span class="p">,</span> <span class="n">add_extension</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="s2">&quot;.csv&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">p_base</span></div>


<div class="viewcode-block" id="sgl_2020_train_path">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.sgl_2020_train_path">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sgl_2020_train_path</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flight data from the 2020 SGL flight data collection - training portion.&quot;&quot;&quot;</span>
    <span class="n">p_base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_DEFAULT_ARTIFACT_DIR</span><span class="p">,</span> <span class="s2">&quot;sgl_2020_train&quot;</span><span class="p">,</span> <span class="s2">&quot;sgl_2020_train&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">remove_extension</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="s2">&quot;_train&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p_base</span><span class="p">,</span> <span class="n">add_extension</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s2">&quot;_train.h5&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">p_base</span></div>


<div class="viewcode-block" id="sgl_2021_train_path">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.sgl_2021_train_path">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sgl_2021_train_path</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flight data from the 2021 SGL flight data collection - training portion.&quot;&quot;&quot;</span>
    <span class="n">p_base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_DEFAULT_ARTIFACT_DIR</span><span class="p">,</span> <span class="s2">&quot;sgl_2021_train&quot;</span><span class="p">,</span> <span class="s2">&quot;sgl_2021_train&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">remove_extension</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="s2">&quot;_train&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p_base</span><span class="p">,</span> <span class="n">add_extension</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s2">&quot;_train.h5&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">p_base</span></div>


<span class="n">EMAG2_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_DEFAULT_ARTIFACT_DIR</span><span class="p">,</span> <span class="s2">&quot;EMAG2&quot;</span><span class="p">,</span> <span class="s2">&quot;EMAG2.h5&quot;</span><span class="p">)</span>
<span class="n">EMM720_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_DEFAULT_ARTIFACT_DIR</span><span class="p">,</span> <span class="s2">&quot;EMM720_World&quot;</span><span class="p">,</span> <span class="s2">&quot;EMM720_World.h5&quot;</span><span class="p">)</span>
<span class="n">NAMAD_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_DEFAULT_ARTIFACT_DIR</span><span class="p">,</span> <span class="s2">&quot;NAMAD_305&quot;</span><span class="p">,</span> <span class="s2">&quot;NAMAD_305.h5&quot;</span><span class="p">)</span> <span class="c1"># Used as default fallback map</span>

<div class="viewcode-block" id="ottawa_area_maps_path">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.ottawa_area_maps_path">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ottawa_area_maps_path</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Magnetic anomaly maps near Ottawa, Ontario, Canada.&quot;&quot;&quot;</span>
    <span class="n">p_base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_DEFAULT_ARTIFACT_DIR</span><span class="p">,</span> <span class="s2">&quot;ottawa_area_maps&quot;</span><span class="p">,</span> <span class="s2">&quot;ottawa_area_maps&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p_base</span><span class="p">,</span> <span class="n">add_extension</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="s2">&quot;.h5&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">p_base</span></div>


<div class="viewcode-block" id="ottawa_area_maps_gxf_path">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.ottawa_area_maps_gxf_path">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ottawa_area_maps_gxf_path</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;GXF versions of small magnetic anomaly maps near Ottawa, Ontario, Canada.&quot;&quot;&quot;</span>
    <span class="n">p_base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_DEFAULT_ARTIFACT_DIR</span><span class="p">,</span> <span class="s2">&quot;ottawa_area_maps_gxf&quot;</span><span class="p">,</span> <span class="s2">&quot;ottawa_area_maps_gxf&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">remove_extension</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="s2">&quot;_Mag&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p_base</span><span class="p">,</span> <span class="n">add_extension</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s2">&quot;_Mag.gxf&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">p_base</span></div>


<span class="c1"># --- Data Structures (Structs to Dataclasses) --- (Map related classes moved to common_types.py)</span>

<div class="viewcode-block" id="MagV">
<a class="viewcode-back" href="../../api_structs.html#magnavpy.magnav.MagV">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MagV</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Vector magnetometer measurement struct.&quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># 1D array x-direction magnetic field [nT]</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># 1D array y-direction magnetic field [nT]</span>
    <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># 1D array z-direction magnetic field [nT]</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># 1D array total magnetic field [nT]</span></div>


<div class="viewcode-block" id="Path">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.Path">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Path</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract type for a flight path.&quot;&quot;&quot;</span>
    <span class="n">N</span><span class="p">:</span> <span class="nb">int</span>          <span class="c1"># number of samples</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span>       <span class="c1"># measurement time step [s]</span>
    <span class="n">tt</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># time [s]</span>
    <span class="n">lat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="c1"># latitude [rad]</span>
    <span class="n">lon</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="c1"># longitude [rad]</span>
    <span class="n">alt</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="c1"># altitude [m]</span>
    <span class="n">vn</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># north velocity [m/s]</span>
    <span class="n">ve</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># east velocity [m/s]</span>
    <span class="n">vd</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># down velocity [m/s]</span></div>

    
<div class="viewcode-block" id="Traj">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.Traj">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Traj</span><span class="p">(</span><span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Trajectory struct (e.g., GPS or truth flight data).&quot;&quot;&quot;</span>
    <span class="n">N</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">tt</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">lat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">lon</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">alt</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vn</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ve</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vd</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">fn</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># north specific force [m/s] - Note: Julia uses [m/s], often specific force is [m/s^2]</span>
    <span class="n">fe</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># east specific force [m/s]</span>
    <span class="n">fd</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># down specific force [m/s]</span>
    <span class="n">Cnb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="c1"># 3x3xN direction cosine matrix (body to navigation)</span></div>


<div class="viewcode-block" id="INS">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.INS">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">INS</span><span class="p">(</span><span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inertial navigation system (INS) struct.&quot;&quot;&quot;</span>
    <span class="n">N</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">tt</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">lat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">lon</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">alt</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vn</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ve</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vd</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">fn</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">fe</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">fd</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">Cnb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">P</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>   <span class="c1"># 17x17xN covariance matrix (or appropriate size)</span></div>


<div class="viewcode-block" id="XYZ">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.XYZ">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">XYZ</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract type for flight data.&quot;&quot;&quot;</span>
    <span class="n">info</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">traj</span><span class="p">:</span> <span class="n">Traj</span>
    <span class="n">ins</span><span class="p">:</span> <span class="n">INS</span>
    <span class="n">flight</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">line</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">year</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">doy</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">diurnal</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">igrf</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></div>


<div class="viewcode-block" id="XYZ0">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.XYZ0">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">XYZ0</span><span class="p">(</span><span class="n">XYZ</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Minimum dataset required for MagNav.&quot;&quot;&quot;</span>
    <span class="n">info</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">traj</span><span class="p">:</span> <span class="n">Traj</span>
    <span class="n">ins</span><span class="p">:</span> <span class="n">INS</span>
    <span class="n">flux_a</span><span class="p">:</span> <span class="n">MagV</span>
    <span class="n">flight</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">line</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">year</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">doy</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">diurnal</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">igrf</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_1_c</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Mag 1 compensated scalar measurements [nT]</span>
    <span class="n">mag_1_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="c1"># Mag 1 uncompensated scalar measurements [nT]</span></div>


<div class="viewcode-block" id="XYZ1">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.XYZ1">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">XYZ1</span><span class="p">(</span><span class="n">XYZ</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flexible dataset for future use.&quot;&quot;&quot;</span>
    <span class="n">info</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">traj</span><span class="p">:</span> <span class="n">Traj</span>
    <span class="n">ins</span><span class="p">:</span> <span class="n">INS</span>
    <span class="n">flux_a</span><span class="p">:</span> <span class="n">MagV</span>
    <span class="n">flux_b</span><span class="p">:</span> <span class="n">MagV</span>
    <span class="n">flight</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">line</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">year</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">doy</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">diurnal</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">igrf</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_1_c</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_2_c</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_3_c</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_1_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_2_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_3_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">aux_1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">aux_2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">aux_3</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></div>


<div class="viewcode-block" id="XYZ20">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.XYZ20">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">XYZ20</span><span class="p">(</span><span class="n">XYZ</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataset for 2020 SGL datasets.&quot;&quot;&quot;</span>
    <span class="n">info</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">traj</span><span class="p">:</span> <span class="n">Traj</span>
    <span class="n">ins</span><span class="p">:</span> <span class="n">INS</span>
    <span class="n">flux_a</span><span class="p">:</span> <span class="n">MagV</span>
    <span class="n">flux_b</span><span class="p">:</span> <span class="n">MagV</span>
    <span class="n">flux_c</span><span class="p">:</span> <span class="n">MagV</span>
    <span class="n">flux_d</span><span class="p">:</span> <span class="n">MagV</span>
    <span class="n">flight</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">line</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">year</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">doy</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">utm_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">utm_y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">utm_z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">msl</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">baro</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">diurnal</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">igrf</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_1_c</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_1_lag</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_1_dc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_1_igrf</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_1_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_2_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_3_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_4_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_5_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_6_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ogs_mag</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ogs_alt</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ins_wander</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ins_roll</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ins_pitch</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ins_yaw</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">roll_rate</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">pitch_rate</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">yaw_rate</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ins_acc_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ins_acc_y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ins_acc_z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">lgtl_acc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ltrl_acc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">nrml_acc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">pitot_p</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">static_p</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">total_p</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_com_1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_ac_hi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_ac_lo</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_tank</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_flap</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_strb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_srvo_o</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_srvo_m</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_srvo_i</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_heat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_acpwr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_outpwr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_bat_1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_bat_2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_acpwr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_outpwr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_bat_1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_bat_2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_res_p</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_res_n</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_back_p</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_back_n</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_gyro_1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_gyro_2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_acc_p</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_acc_n</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_block</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_back</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_srvo</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_cabt</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_fan</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">aux_1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">aux_2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">aux_3</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></div>


<div class="viewcode-block" id="XYZ21">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.XYZ21">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">XYZ21</span><span class="p">(</span><span class="n">XYZ</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataset for 2021 SGL datasets.&quot;&quot;&quot;</span>
    <span class="n">info</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">traj</span><span class="p">:</span> <span class="n">Traj</span>
    <span class="n">ins</span><span class="p">:</span> <span class="n">INS</span>
    <span class="n">flux_a</span><span class="p">:</span> <span class="n">MagV</span>
    <span class="n">flux_b</span><span class="p">:</span> <span class="n">MagV</span>
    <span class="n">flux_c</span><span class="p">:</span> <span class="n">MagV</span>
    <span class="n">flux_d</span><span class="p">:</span> <span class="n">MagV</span>
    <span class="n">flight</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">line</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">year</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">doy</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">utm_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">utm_y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">utm_z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">msl</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">baro</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">diurnal</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">igrf</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_1_c</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_1_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_2_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_3_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_4_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag_5_uc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_com_1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_ac_hi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_ac_lo</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_tank</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_flap</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">cur_strb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_block</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_back</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_cabt</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vol_fan</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">aux_1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">aux_2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">aux_3</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></div>


<div class="viewcode-block" id="FILTres">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.FILTres">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FILTres</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter results struct.&quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>    <span class="c1"># Filtered states</span>
    <span class="n">P</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>    <span class="c1"># Non-linear covariance matrix</span>
    <span class="n">r</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>    <span class="c1"># Measurement residuals [nT]</span>
    <span class="n">c</span><span class="p">:</span> <span class="nb">bool</span>          <span class="c1"># True if filter converged</span></div>


<div class="viewcode-block" id="CRLBout">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.CRLBout">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CRLBout</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cramér–Rao lower bound extracted output struct.&quot;&quot;&quot;</span>
    <span class="n">lat_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">lon_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">alt_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vn_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ve_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vd_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">tn_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">te_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">td_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">fogm_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">n_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">e_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></div>


<div class="viewcode-block" id="INSout">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.INSout">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">INSout</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inertial navigation system extracted output struct.&quot;&quot;&quot;</span>
    <span class="n">lat_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">lon_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">alt_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">n_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">e_std</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">lat_err</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">lon_err</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">alt_err</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">n_err</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></div>


<div class="viewcode-block" id="FILTout">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.FILTout">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FILTout</span><span class="p">(</span><span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter output struct.&quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">P</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">r</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">c</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">lat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">lon</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">alt</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vn</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">ve</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">vd</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">f</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">h</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">mag</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">bias</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">scale</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">Mis_e</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">Mis_a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">diurnal</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">igrf</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">t_m</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">t_f</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">t_h</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">t_bias</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">t_scale</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">t_mis_e</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">t_mis_a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">t_diurnal</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">t_igrf</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">t_xyz</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></div>


<div class="viewcode-block" id="CompParams">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.CompParams">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CompParams</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base type for compensation parameters.&quot;&quot;&quot;</span>
    <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="c1"># Fields used in the regression or training</span></div>

    
<div class="viewcode-block" id="LinCompParams">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.LinCompParams">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LinCompParams</span><span class="p">(</span><span class="n">CompParams</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Linear aeromagnetic compensation parameters struct.&quot;&quot;&quot;</span>
    <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">a_m</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">a_f</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">a_h</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">a_bias</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">a_scale</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">a_mis_e</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">a_mis_a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></div>

    
<div class="viewcode-block" id="NNCompParams">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.NNCompParams">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NNCompParams</span><span class="p">(</span><span class="n">CompParams</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Neural network-based aeromagnetic compensation parameters struct.&quot;&quot;&quot;</span>
    <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">nn</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">data_norms</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="TempParams">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.TempParams">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TempParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Temp related parameters, primarily for mag correction.&quot;&quot;&quot;</span>
    <span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">B</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">C</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></div>


<span class="k">def</span><span class="w"> </span><span class="nf">_ekf_rt_create_P0_default</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_ekf_rt_create_Qd_default</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>

<div class="viewcode-block" id="EKF_RT">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.EKF_RT">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EKF_RT</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Real-time (RT) extended Kalman filter (EKF) struct, mutable.&quot;&quot;&quot;</span>
    <span class="n">P</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">_ekf_rt_create_P0_default</span><span class="p">)</span>
    <span class="n">Qd</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">_ekf_rt_create_Qd_default</span><span class="p">)</span>
    <span class="n">R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span></div>


<span class="c1"># --- Helper functions for access / general utilities ---</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.analysis_util</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_bpf</span><span class="p">,</span> <span class="n">bpf_data</span><span class="p">,</span> <span class="n">linreg</span><span class="p">,</span> <span class="n">calc_crlb_pos</span><span class="p">,</span> <span class="n">calc_crlb_vel</span><span class="p">,</span> <span class="n">calc_crlb_att</span><span class="p">,</span> <span class="n">calc_crlb_fogm</span><span class="p">,</span> <span class="n">calc_crlb_map</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.create_xyz</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_xyz0</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.tolles_lawson</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_tl_a</span><span class="p">,</span> <span class="n">create_tl_coef</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.model_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_model</span><span class="p">,</span> <span class="n">create_P0</span> <span class="k">as</span> <span class="n">create_p0</span><span class="p">,</span> <span class="n">create_Qd</span> <span class="k">as</span> <span class="n">create_qd</span><span class="p">,</span> <span class="n">get_Phi</span><span class="p">,</span> <span class="n">get_H</span><span class="p">,</span> <span class="n">get_h</span><span class="p">,</span> <span class="n">get_f</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.ekf</span><span class="w"> </span><span class="kn">import</span> <span class="n">crlb</span><span class="p">,</span> <span class="n">ekf</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.get_map</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_map</span><span class="p">,</span> <span class="n">ottawa_area_maps</span><span class="p">,</span> <span class="n">namad</span><span class="p">,</span> <span class="n">emag2</span><span class="p">,</span> <span class="n">emm720</span><span class="p">,</span> <span class="n">upward_fft</span><span class="p">,</span> <span class="n">map_interpolate</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.plot_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_mag</span>
    <span class="c1"># NOTE: These imports are not directly used in the current version of magnav.py as per</span>
    <span class="c1"># the existing logic and might be part of an unused &quot;data_loader&quot; internal Julia module.</span>
    <span class="c1"># We define placeholders so Sphinx doesn&#39;t complain about missing references later.</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.get_xyz</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_xyz0</span><span class="p">,</span> <span class="n">get_xyz20</span><span class="p">,</span> <span class="n">get_XYZ</span><span class="p">,</span> <span class="n">sgl_2020_train</span><span class="p">,</span> <span class="n">sgl_2021_train</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.google_earth</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_kml</span>
<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not import MagNavPy sub-modules. Some functions might be unavailable: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
    <span class="c1"># Define placeholder functions/classes so code that calls them doesn&#39;t error immediately</span>
    <span class="c1"># during Sphinx autodoc processing. These are minimal and will likely cause runtime errors.</span>

<div class="viewcode-block" id="get_bpf">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.get_bpf">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_bpf</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;get_bpf requires analysis_util module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="bpf_data">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.bpf_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">bpf_data</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;bpf_data requires analysis_util module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="linreg">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.linreg">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">linreg</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;linreg requires analysis_util module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="calc_crlb_pos">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.calc_crlb_pos">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calc_crlb_pos</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;calc_crlb_pos requires analysis_util module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="calc_crlb_vel">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.calc_crlb_vel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calc_crlb_vel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;calc_crlb_vel requires analysis_util module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="calc_crlb_att">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.calc_crlb_att">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calc_crlb_att</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;calc_crlb_att requires analysis_util module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="calc_crlb_fogm">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.calc_crlb_fogm">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calc_crlb_fogm</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;calc_crlb_fogm requires analysis_util module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="calc_crlb_map">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.calc_crlb_map">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calc_crlb_map</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;calc_crlb_map requires analysis_util module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="create_xyz0">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.create_xyz0">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_xyz0</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;create_xyz0 requires create_xyz module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="create_tl_a">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.create_tl_a">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_tl_a</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;create_tl_a requires tolles_lawson module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="create_tl_coef">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.create_tl_coef">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_tl_coef</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;create_tl_coef requires tolles_lawson module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="create_model">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.create_model">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_model</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;create_model requires model_functions module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="create_p0">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.create_p0">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_p0</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;create_p0 requires model_functions module.&quot;</span><span class="p">)</span> <span class="c1"># Case sensitive in real code</span></div>

<div class="viewcode-block" id="create_qd">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.create_qd">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_qd</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;create_qd requires model_functions module.&quot;</span><span class="p">)</span> <span class="c1"># Case sensitive in real code</span></div>

<div class="viewcode-block" id="get_Phi">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.get_Phi">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_Phi</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;get_Phi requires model_functions module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_H">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.get_H">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_H</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;get_H requires model_functions module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_h">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.get_h">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_h</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;get_h requires model_functions module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_f">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.get_f">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;get_f requires model_functions module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="crlb">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.crlb">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">crlb</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;crlb requires ekf module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ekf">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.ekf">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ekf</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;ekf requires ekf module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_map">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.get_map">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_map</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;get_map requires get_map module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ottawa_area_maps">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.ottawa_area_maps">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ottawa_area_maps</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;ottawa_area_maps requires get_map module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="namad">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.namad">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">namad</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;namad requires get_map module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emag2">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.emag2">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">emag2</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;emag2 requires get_map module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emm720">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.emm720">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">emm720</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;emm720 requires get_map module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="upward_fft">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.upward_fft">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">upward_fft</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;upward_fft requires get_map module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="map_interpolate">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.map_interpolate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">map_interpolate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;map_interpolate requires get_map module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="plot_mag">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.plot_mag">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_mag</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;plot_mag requires plot_functions module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_xyz0">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.get_xyz0">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_xyz0</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;get_xyz0 requires get_xyz module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_xyz20">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.get_xyz20">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_xyz20</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;get_xyz20 requires get_xyz module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_XYZ">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.get_XYZ">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_XYZ</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;get_XYZ requires get_xyz module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="sgl_2020_train">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.sgl_2020_train">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">sgl_2020_train</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;sgl_2020_train requires get_xyz module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="sgl_2021_train">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.sgl_2021_train">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">sgl_2021_train</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;sgl_2021_train requires get_xyz module.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="create_kml">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.create_kml">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_kml</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;create_kml requires google_earth module.&quot;</span><span class="p">)</span></div>


<span class="c1"># Constants as defined in magnav.jl for gravity and Earth&#39;s rotation based on coordinate system setup details</span>
<span class="c1"># This should also account for the difference if from Julia&#39;s GeoData or other packages</span>
<span class="c1"># It&#39;s better to ensure these are consistent with Python&#39;s usual geo libraries (e.g., pyproj, geographiclib)</span>
<span class="c1"># For now, adopting values directly from MagNav.jl as presented.</span>
<span class="n">r_earth</span> <span class="o">=</span> <span class="n">R_EARTH</span>
<span class="n">omega_earth</span> <span class="o">=</span> <span class="n">OMEGA_EARTH</span>

<div class="viewcode-block" id="get_cached_map">
<a class="viewcode-back" href="../../api_reference.html#magnavpy.magnav.get_cached_map">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_cached_map</span><span class="p">(</span><span class="n">maps</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">MapS</span><span class="p">],</span> <span class="n">MapS</span><span class="p">],</span> <span class="n">fallback</span><span class="p">:</span> <span class="n">MapS</span> <span class="o">=</span> <span class="n">MAP_S_NULL</span><span class="p">,</span> <span class="n">dz</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MapCache</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves or creates a cached map object.</span>

<span class="sd">    Args:</span>
<span class="sd">        maps: A list of `MapS` objects or a single `MapS` object to use as the base map(s).</span>
<span class="sd">        fallback: An optional `MapS` object to use as a fallback if no suitable map is found in `maps`.</span>
<span class="sd">                 Defaults to `MAP_S_NULL`.</span>
<span class="sd">        dz: The altitude discretization for the cache [m].</span>

<span class="sd">    Returns:</span>
<span class="sd">        A `MapCache` object containing the interpolated maps.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">maps_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">maps</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maps</span><span class="p">,</span> <span class="n">MapS</span><span class="p">)</span> <span class="k">else</span> <span class="n">maps</span>
    <span class="k">return</span> <span class="n">MapCache</span><span class="p">(</span><span class="n">maps_list</span><span class="p">,</span> <span class="n">fallback</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span></div>


<div class="viewcode-block" id="run_filt">
<a class="viewcode-back" href="../../nav.html#magnavpy.magnav.run_filt">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">run_filt</span><span class="p">(</span><span class="n">ins</span><span class="p">:</span> <span class="n">INS</span><span class="p">,</span> <span class="n">xyz</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">XYZ0</span><span class="p">,</span> <span class="n">XYZ1</span><span class="p">,</span> <span class="n">XYZ20</span><span class="p">,</span> <span class="n">XYZ21</span><span class="p">],</span> <span class="n">filter_params</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
             <span class="n">mag_map</span><span class="p">:</span> <span class="n">MapS</span> <span class="o">=</span> <span class="n">MAP_S_NULL</span><span class="p">,</span> <span class="n">temp_params</span><span class="p">:</span> <span class="n">TempParams</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FILTres</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs the specified filter (Extended Kalman Filter or Neural EKF for now)</span>
<span class="sd">    and returns its results.</span>

<span class="sd">    Args:</span>
<span class="sd">        ins: INS data.</span>
<span class="sd">        xyz: Flight data (XYZ0, XYZ1, XYZ20, or XYZ21).</span>
<span class="sd">        filter_params: Filter parameters (e.g., EKF_RT).</span>
<span class="sd">        mag_map: A `MapS` object representing the magnetic anomaly map. Defaults to `MAP_S_NULL`.</span>
<span class="sd">        temp_params: (Optional) Temperature compensation parameters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A `FILTres` object containing the filter results.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filter_params</span><span class="p">,</span> <span class="n">EKF_RT</span><span class="p">):</span>
        <span class="c1"># Placeholder for calling the EKF function</span>
        <span class="c1"># from .ekf import ekf # This import will be needed</span>
        <span class="n">x_est</span><span class="p">,</span> <span class="n">P_est</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">converged</span> <span class="o">=</span> <span class="n">ekf</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">filter_params</span><span class="p">,</span> <span class="n">mag_map</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">FILTres</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_est</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P_est</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">converged</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Only EKF_RT is currently implemented for filtering.&quot;</span><span class="p">)</span></div>


<span class="c1"># Define placeholder for _undefined_in_all for modules that might use it</span>
<span class="n">_undefined_in_all</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Placeholder for types/functions that might be imported but were not available in original Julia setup</span>
    <span class="c1"># and might cause issues during direct translation.</span>
    <span class="c1"># This list would contain string names like &quot;some_type&quot;, &quot;some_function&quot; if they were found and not translated.</span>
<span class="p">]</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">MagNavPy</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../data.html">Flight Path &amp; INS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maps.html">Magnetic Anomaly Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../comp.html">Aeromagnetic Compensation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nncomp.html">Neural Network-Based Model Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nav.html">Navigation Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_functions.html">API: Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_structs.html">API: Structs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, MagNav.jl Authors & AI Porting Team.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>